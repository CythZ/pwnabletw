# silver bullet

## 漏洞

程序流程是站上有个长度为`0x30`的字符串，紧邻这个字符串的位置存储了它的长度，每次`power_up`都会根据这个长度值进行判断。但是`strncat`会在复制完成之后添加`\x00`于是引起存储字符串长度的位置被清零，栈溢出。

## 思路

创建的时候输入`0x2f`个数据，然后在补充`0x1`个数据，保证`len`位置是最小的，接下来可以输入`0x2f`长度的`payload`。

先打印`puts_got`，计算基址，再返回到`main`再来一次，返回到`system`就可以了

题目的`Return`选项用的是`exit(0)`退出，不可以用。需要用`beat`来进行`return`。

`beat`里面有个判断：

```c
*a2 -= *(_DWORD *)(a1 + 48);
if(*a <= 0){
    puts("Oh ! You win !!");
    result = 1;
}
```

`a1+48`就是`len`。所以这里在填充payload的时候可以用`\xff`。